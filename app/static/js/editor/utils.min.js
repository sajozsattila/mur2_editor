"use strict";function documentReady(e){"loading"!=document.readyState?e():document.addEventListener("DOMContentLoaded",e)}function findBisect(e,t){var n=0,r=t.length-1,i=t[n];if(i>=e)return{val:n,part:0};var a=t[r];if(a<e)return{val:r,part:0};for(;r-n>1;){var l=n+Math.round((r-n)/2),o=t[l];o>=e?(r=l,a=o):(n=l,i=o)}return{val:n,part:(e-i)/(a-i)}}function substrCount(e,t){for(var n=-1,r=-2;-1!=r;)n++,r=t.indexOf(e,r+1);return n}function selectText(e){if(window.getSelection){var t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}}function Animator(e,t){var n,r,i,a,l,o=0,s=0,c=0,u=0,f=200,v=null,d=function(e){null===v&&(v=e);var s=e-v;s<r?(o=c+i*(Math.cos(a*(s-r))-1),u=i*a*Math.sin(a*(r-s)),t(o),n=requestAnimationFrame(d),m&&(h(l,o),m=!1,v=e)):(v=null,u=0,t(c),cancelAnimationFrame(n),m&&(m=!1))},m=!1;function h(e,t){var n;if(c=e,s=t,Math.abs(u)<1e-5)n=Math.PI,r=f;else{var l=(c-s)/u/f;n=l<0||l>.5?Math.PI*Math.sqrt(1-.5/l):.1;var o=(1-Math.cos(n))/n/Math.sin(n);r=(c-s)/o/u}a=n/r,i=(c-s)/(1-Math.cos(n))}this.setPos=function(t){(m=null!==v)?l=t:(h(t,o=e()),n=requestAnimationFrame(d))},this.stop=function(){v=null,u=0,cancelAnimationFrame(n),m=!1}}function escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ImagePreloader(){var e={},t=0;function n(){var e;e=this.status>=200&&this.status<400?this.responseText:'<svg height="24" version="1.1" width="24" xmlns="http://www.w3.org/2000/svg"><g transform="translate(0 -1028.4)"><path d="m22 12c0 5.523-4.477 10-10 10-5.5228 0-10-4.477-10-10 0-5.5228 4.4772-10 10-10 5.523 0 10 4.4772 10 10z" fill="#742600" transform="translate(0 1029.4)"/><path d="m22 12c0 5.523-4.477 10-10 10-5.5228 0-10-4.477-10-10 0-5.5228 4.4772-10 10-10 5.523 0 10 4.4772 10 10z" fill="#AB562B" transform="translate(0 1028.4)"/><path d="m7.0503 1037.8 3.5357 3.6-3.5357 3.5 1.4142 1.4 3.5355-3.5 3.536 3.5 1.414-1.4-3.536-3.5 3.536-3.6-1.414-1.4-3.536 3.5-3.5355-3.5-1.4142 1.4z" fill="#742600"/><path d="m7.0503 1036.8 3.5357 3.6-3.5357 3.5 1.4142 1.4 3.5355-3.5 3.536 3.5 1.414-1.4-3.536-3.5 3.536-3.6-1.414-1.4-3.536 3.5-3.5355-3.5-1.4142 1.4z" fill="#ecf0f1"/></g></svg>',i(this.responseURL||this.s2Url,e,this.prefix)}function r(e,t){var r=new XMLHttpRequest;return r.open("GET",e,!0),r.s2Url=e,r.prefix=t,r.onload=n,r.onerror=function(){},r.send(),r}this.onLoad=function(t,n,i){e[t]?null!==e[t].svg&&n(t,e[t].svg,e[t].baseline,i):e[t]={svg:null,baseline:null,request:r(t,i),callback:n}};var i=function(n,r,i){var a=e[n];if(a){var l=(r=function(e){var n=e.match(/id=["']([^"']*)["']/g);if(!n)return e;for(var r,i,a,l=n.length;l--;)r=(a=n[l]).match(/id=["']([^"']*)["']/)[1],i="s"+t+r,e=e.replaceAll(a,'id="'+i+'"').replaceAll("#"+r,"#"+i);return t++,e}(r)).match(/postMessage\((?:&quot;|")([\d\|\.\-eE]*)(?:&quot;|")/);if(l)var o=l&&l[1]?l[1].split("|").shift():0;else o=null;a.callback(n,r,o,i),a.svg=r,a.baseline=o,a.request=null,a.callback=null}};this.getImageDataFromUrl=function(t){var n=e[t];return n||null}}function ImageLoader(e,t,n){var r=[],i=[],a={},l=0,o=null,s=null,c=null,u=1;this.loaderid=n,this.reset=function(){r=[],l=0,u=1};var f=function(e,t,n,r){var i,l=a[e];if(l&&(i=l.length))for(;i--;){var f=l[i];v(f,t,n,f===s?"fade-in":"replace",r)&&(u+=1),f===s&&(clearTimeout(o),s=null,c=null)}};function v(e,t,n,r,i){var a=i+"s2tex_"+e,l=document.getElementById(a),s=l.parentNode,c="fade-out"==r?"0.5":"1",f='<svg class="svg-preview" id="'+a+'" ',v=!1;if("center"===s.style.textAlign&&(s.id.match(/eq\:.*$/)&&1==s.childElementCount)){v=!0;var d=document.createElement("em");d.innerHTML="("+u+")";var m=document.createElement("span");s.insertBefore(d,l),s.appendChild(m)}var h=t.match(/ height="[\.\d]+" /g)[0].trim().split("=")[1].replace(/"/g,"");f+=null===n?'width="13px" height="13px" ':'style="--latex_align: '+-n+"pt; --latex_height: "+h+"px; vertical-align:"+-n+'pt; opacity: 1" ';var p=document.createElement("div");p.innerHTML=t.replace("<svg ",f);var g=p.firstElementChild;return p.removeChild(g),s.insertBefore(g,l),s.removeChild(l),"1"!=c&&(o=setTimeout(function(){document.getElementById(a).style.opacity=c},0)),v}this.getHtmlStub=function(e){r[l]=t+"//mur2.co.uk/math/svg/"+encodeURIComponent(e);var n='<span id="'+this.loaderid+"s2tex_"+l+'"></span>';return l++,n},this.fixDom=function(){!function(){if(l==i.length){for(var e,t=0,n=l;n--;)r[n]!=i[n]&&(t++,e=n);if(1==t){if(null===s)return s=e,void(c=i[e]);if(s===e)return}}s=null,c=null}(),function(){a={};for(var e=l;e--;){var t=r[e];void 0===a[t]?a[t]=[e]:(a[t].push(e),a[t].sort(function(e,t){return t-e}))}}();for(var t=0;t<l;t++)e.onLoad(r[t],f,this.loaderid);if(null!==s){var n=e.getImageDataFromUrl(c);if(null!==n&&null===n.callback)v(s,n.svg,n.baseline,"fade-out",this.loaderid)&&(u+=1)}i=r.slice(0)}}function ScrollMap(e){var t=null;this.reset=function(){t=[null,null]},this.getPosition=function(n,r,i){var a=n.offsetHeight,l=n.scrollTop;if(0==l)return 0;null===t[r]&&(t=e());var o=t[r].length-1;if(t[r][o]<=l+a)return t[i][o]-a;var s=a/2,c=findBisect(l+s,t[r]),u=parseFloat(t[i][c.val]*(1-c.part));return t[i][c.val+1]&&(u+=parseFloat(t[i][c.val+1]*c.part)),u-s}}function SyncScroll(e,t,n,r,i,a){var l=function(){n.setPos(e.getPosition(r,0,1))},o=function(){t.setPos(e.getPosition(i,1,0))};this.switchScrollToSrc=function(){i.removeEventListener("scroll",o),r.removeEventListener("scroll",l),r.addEventListener("scroll",l),a.id="container-block-source"},this.switchScrollToResult=function(){r.removeEventListener("scroll",l),i.removeEventListener("scroll",o),i.addEventListener("scroll",o),a.id="container-block-result"}}String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(escapeRegExp(e),"g"),t)};var now=Date.now||function(){return(new Date).getTime()};function debounce(e,t,n){var r,i,a,l,o,s,c,u=0,f=!1,v=!1,d=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT);function m(t,n){n&&clearTimeout(n),i=s=c=void 0,t&&(u=now(),a=e.apply(o,r),s||i||(r=o=void 0))}function h(){var e=t-(now()-l);e<=0||e>t?m(c,i):s=setTimeout(h,e)}function p(){m(d,s)}function g(){if(r=arguments,l=now(),o=this,c=d&&(s||!f),!1===v)var n=f&&!s;else{i||f||(u=l);var m=v-(l-u),g=m<=0||m>v;g?(i&&(i=clearTimeout(i)),u=l,a=e.apply(o,r)):i||(i=setTimeout(p,m))}return g&&s?s=clearTimeout(s):s||t===v||(s=setTimeout(h,t)),n&&(g=!0,a=e.apply(o,r)),!g||s||i||(r=o=void 0),a}return t=t<0?0:+t||0,"object"==typeof n&&(f=!!n.leading,v="maxWait"in n&&Math.max(+n.maxWait||0,t),d="trailing"in n?!!n.trailing:d),g.cancel=function(){s&&clearTimeout(s),i&&clearTimeout(i),u=0,i=s=c=void 0},g}