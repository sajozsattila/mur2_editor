!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).markdownItAttrs=t()}}(function(){return function(){return function t(e,n,i){function r(o,s){if(!n[o]){if(!e[o]){var f="function"==typeof require&&require;if(!s&&f)return f(o,!0);if(l)return l(o,!0);var a=new Error("Cannot find module '"+o+"'");throw a.code="MODULE_NOT_FOUND",a}var c=n[o]={exports:{}};e[o][0].call(c.exports,function(t){return r(e[o][1][t]||t)},c,c.exports,t,e,n,i)}return n[o].exports}for(var l="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}}()({1:[function(t,e,n){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=t("./patterns.js"),l={leftDelimiter:"{",rightDelimiter:"}",allowedAttributes:[]};
/**
 * Test if t matches token stream.
 *
 * @param {array} tokens
 * @param {number} i
 * @param {object} t Test to match.
 * @return {object} { match: true|false, j: null|number }
 */
function o(t,e,n){var r,l,s={match:!1,j:null},f=void 0!==n.shift?e+n.shift:n.position,a=(r=t,(l=f)>=0?r[l]:r[r.length+l]);if(void 0===a)return s;var c=function(t){if("shift"===t||"position"===t)return"continue";if(void 0===a[t])return{v:s};if("children"===t&&(r=n.children,Array.isArray(r)&&r.length&&r.every(function(t){return"object"===i(t)}))){var e=function(){if(0===a.children.length)return{v:{v:s}};var t,e,i=n.children,r=a.children;if(i.every(function(t){return void 0!==t.position})){if(t=i.every(function(t){return o(r,t.position,t).match})){var l=(e=i,e.slice(-1)[0]||{}).position;s.j=l>=0?l:r.length+l}}else for(var f=function(e){if(t=i.every(function(t){return o(r,e,t).match}))return s.j=e,"break"},c=0;c<r.length;c++){if("break"===f(c))break}return!1===t?{v:{v:s}}:{v:"continue"}}();if("object"===i(e))return e.v}var r;switch(i(n[t])){case"boolean":case"number":case"string":if(a[t]!==n[t])return{v:s};break;case"function":if(!n[t](a[t]))return{v:s};break;case"object":if(function(t){return Array.isArray(t)&&t.length&&t.every(function(t){return"function"==typeof t})}
/**
 * Get n item of array. Supports negative n, where -1 is last
 * element in array.
 * @param {array} arr
 * @param {number} n
 */(n[t])){if(!1===n[t].every(function(e){return e(a[t])}))return{v:s};break}default:throw new Error("Unknown type of pattern test (key: ".concat(t,"). Test should be of type boolean, number, string, function or array of functions."))}};for(var u in n){var h=c(u);switch(h){case"continue":continue;default:if("object"===i(h))return h.v}}return s.match=!0,s}e.exports=function(t,e){var n=Object.assign({},l);n=Object.assign(n,e);var i=r(n);t.core.ruler.before("linkify","curly_attributes",function(t){for(var e=t.tokens,n=function(t){for(var n=0;n<i.length;n++){var r=i[n],l=null;r.tests.every(function(n){var i=o(e,t,n);return null!==i.j&&(l=i.j),i.match})&&(r.transform(e,t,l),"inline attributes"!==r.name&&"inline nesting 0"!==r.name||n--)}},r=0;r<e.length;r++)n(r)})}},{"./patterns.js":2}],2:[function(t,e,n){"use strict";
/**
 * If a pattern matches the token stream,
 * then run transform.
 */var i=t("./utils.js");function r(t){return t.slice(-1)[0]}e.exports=function(t){var e=new RegExp("^ {0,3}[-*_]{3,} ?"+i.escapeRegExp(t.leftDelimiter)+"[^"+i.escapeRegExp(t.rightDelimiter)+"]");return[{
/**
     * ```python {.cls}
     * for i in range(10):
     *     print(i)
     * ```
     */
name:"fenced code blocks",tests:[{shift:0,block:!0,info:i.hasDelimiters("end",t)}],transform:function(e,n){var r=e[n],l=r.info.lastIndexOf(t.leftDelimiter),o=i.getAttrs(r.info,l,t);i.addAttrs(o,r),r.info=i.removeDelimiter(r.info,t)}},{
/**
     * bla `click()`{.c} ![](img.png){.d}
     *
     * differs from 'inline attributes' as it does
     * not have a closing tag (nesting: -1)
     */
name:"inline nesting 0",tests:[{shift:0,type:"inline",children:[{shift:-1,type:function(t){return"image"===t||"code_inline"===t}},{shift:0,type:"text",content:i.hasDelimiters("start",t)}]}],transform:function(e,n,r){var l=e[n].children[r],o=l.content.indexOf(t.rightDelimiter),s=e[n].children[r-1],f=i.getAttrs(l.content,0,t);i.addAttrs(f,s),l.content.length===o+t.rightDelimiter.length?e[n].children.splice(r,1):l.content=l.content.slice(o+t.rightDelimiter.length)}},{
/**
     * | h1 |
     * | -- |
     * | c1 |
     * {.c}
     */
name:"tables",tests:[{shift:0,type:"table_close"},{shift:1,type:"paragraph_open"},{shift:2,type:"inline",content:i.hasDelimiters("only",t)}],transform:function(e,n){var r=e[n+2],l=i.getMatchingOpeningToken(e,n),o=i.getAttrs(r.content,0,t);i.addAttrs(o,l),e.splice(n+1,3)}},{
/**
     * *emphasis*{.with attrs=1}
     */
name:"inline attributes",tests:[{shift:0,type:"inline",children:[{shift:-1,nesting:-1},{shift:0,type:"text",content:i.hasDelimiters("start",t)}]}],transform:function(e,n,r){var l=e[n].children[r],o=l.content,s=i.getAttrs(o,0,t),f=i.getMatchingOpeningToken(e[n].children,r-1);i.addAttrs(s,f),l.content=o.slice(o.indexOf(t.rightDelimiter)+t.rightDelimiter.length)}},{
/**
     * - item
     * {.a}
     */
name:"list softbreak",tests:[{shift:-2,type:"list_item_open"},{shift:0,type:"inline",children:[{position:-2,type:"softbreak"},{position:-1,type:"text",content:i.hasDelimiters("only",t)}]}],transform:function(e,n,r){for(var l=e[n].children[r].content,o=i.getAttrs(l,0,t),s=n-2;e[s-1]&&"ordered_list_open"!==e[s-1].type&&"bullet_list_open"!==e[s-1].type;)s--;i.addAttrs(o,e[s-1]),e[n].children=e[n].children.slice(0,-2)}},{
/**
     * - nested list
     *   - with double \n
     *   {.a} <-- apply to nested ul
     *
     * {.b} <-- apply to root <ul>
     */
name:"list double softbreak",tests:[{shift:0,type:function(t){return"bullet_list_close"===t||"ordered_list_close"===t}},{shift:1,type:"paragraph_open"},{shift:2,type:"inline",content:i.hasDelimiters("only",t),children:function(t){return 1===t.length}},{shift:3,type:"paragraph_close"}],transform:function(e,n){var r=e[n+2].content,l=i.getAttrs(r,0,t),o=i.getMatchingOpeningToken(e,n);i.addAttrs(l,o),e.splice(n+1,3)}},{
/**
     * - end of {.list-item}
     */
name:"list item end",tests:[{shift:-2,type:"list_item_open"},{shift:0,type:"inline",children:[{position:-1,type:"text",content:i.hasDelimiters("end",t)}]}],transform:function(e,n,l){var o=e[n].children[l],s=o.content,f=i.getAttrs(s,s.lastIndexOf(t.leftDelimiter),t);i.addAttrs(f,e[n-2]);var a=s.slice(0,s.lastIndexOf(t.leftDelimiter));o.content=" "!==r(a)?a:a.slice(0,-1)}},{
/**
     * something with softbreak
     * {.cls}
     */
name:"\n{.a} softbreak then curly in start",tests:[{shift:0,type:"inline",children:[{position:-2,type:"softbreak"},{position:-1,type:"text",content:i.hasDelimiters("only",t)}]}],transform:function(e,n,r){for(var l=e[n].children[r],o=i.getAttrs(l.content,0,t),s=n+1;e[s+1]&&-1===e[s+1].nesting;)s++;var f=i.getMatchingOpeningToken(e,s);i.addAttrs(o,f),e[n].children=e[n].children.slice(0,-2)}},{
/**
     * horizontal rule --- {#id}
     */
name:"horizontal rule",tests:[{shift:0,type:"paragraph_open"},{shift:1,type:"inline",children:function(t){return 1===t.length},content:function(t){return null!==t.match(e)}},{shift:2,type:"paragraph_close"}],transform:function(e,n){var r=e[n];r.type="hr",r.tag="hr",r.nesting=0;var l=e[n+1].content,o=l.lastIndexOf(t.leftDelimiter);r.attrs=i.getAttrs(l,o,t),r.markup=l,e.splice(n+1,2)}},{
/**
     * end of {.block}
     */
name:"end of block",tests:[{shift:0,type:"inline",children:[{position:-1,content:i.hasDelimiters("end",t),type:function(t){return"code_inline"!==t}}]}],transform:function(e,n,l){for(var o=e[n].children[l],s=o.content,f=i.getAttrs(s,s.lastIndexOf(t.leftDelimiter),t),a=n+1;e[a+1]&&-1===e[a+1].nesting;)a++;var c=i.getMatchingOpeningToken(e,a);i.addAttrs(f,c);var u=s.slice(0,s.lastIndexOf(t.leftDelimiter));o.content=" "!==r(u)?u:u.slice(0,-1)}}]}},{"./utils.js":3}],3:[function(t,e,n){"use strict";
/**
 * parse {.class #id key=val} strings
 * @param {string} str: string to parse
 * @param {int} start: where to start parsing (including {)
 * @returns {2d array}: [['key', 'val'], ['class', 'red']]
 */
/**
 * Escapes special characters in string s such that the string
 * can be used in `new RegExp`. For example "[" becomes "\\[".
 *
 * @param {string} s Regex string.
 * @return {string} Escaped string.
 */
function i(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}n.getAttrs=function(t,e,n){for(var i=/[^\t\n\f />"'=]/,r=[],l="",o="",s=!0,f=!1,a=e+n.leftDelimiter.length;a<t.length;a++){if(t.slice(a,a+n.rightDelimiter.length)===n.rightDelimiter){""!==l&&r.push([l,o]);break}var c=t.charAt(a);if("="===c&&s)s=!1;else if("."!==c||""!==l)if("#"!==c||""!==l)if('"'!==c||""!==o)if('"'===c&&f)f=!1;else if(" "!==c||f)s&&-1===c.search(i)||(s?l+=c:o+=c);else{if(""===l)continue;r.push([l,o]),l="",o="",s=!0}else f=!0;else l="id",s=!1;else"."===t.charAt(a+1)?(l="css-module",a+=1):l="class",s=!1}if(n.allowedAttributes&&n.allowedAttributes.length){var u=n.allowedAttributes;return r.filter(function(t){var e=t[0];return u.some(function(t){return e===t||t instanceof RegExp&&t.test(e)})})}return r},
/**
 * add attributes from [['key', 'val']] list
 * @param {array} attrs: [['key', 'val']]
 * @param {token} token: which token to add attributes
 * @returns token
 */
n.addAttrs=function(t,e){for(var n=0,i=t.length;n<i;++n){var r=t[n][0];"class"===r?e.attrJoin("class",t[n][1]):"css-module"===r?e.attrJoin("css-module",t[n][1]):e.attrPush(t[n])}return e},
/**
 * Does string have properly formatted curly?
 *
 * start: '{.a} asdf'
 * middle: 'a{.b}c'
 * end: 'asdf {.a}'
 * only: '{.a}'
 *
 * @param {string} where to expect {} curly. start, middle, end or only.
 * @return {function(string)} Function which testes if string has curly.
 */
n.hasDelimiters=function(t,e){if(!t)throw new Error('Parameter `where` not passed. Should be "start", "middle", "end" or "only".');
/**
   * @param {string} str
   * @return {boolean}
   */return function(n){var i,r,l,o=e.leftDelimiter.length+1+e.rightDelimiter.length;if(!n||"string"!=typeof n||n.length<o)return!1;var s,f,a,c=o-e.rightDelimiter.length;switch(t){case"start":r=-1===(i=n.slice(0,e.leftDelimiter.length)===e.leftDelimiter?0:-1)?-1:n.indexOf(e.rightDelimiter,c),(l=n.charAt(r+e.rightDelimiter.length))&&-1!==e.rightDelimiter.indexOf(l)&&(r=-1);break;case"end":r=(r=-1===(i=n.lastIndexOf(e.leftDelimiter))?-1:n.indexOf(e.rightDelimiter,i+c))===n.length-e.rightDelimiter.length?r:-1;break;case"only":i=n.slice(0,e.leftDelimiter.length)===e.leftDelimiter?0:-1,r=n.slice(n.length-e.rightDelimiter.length)===e.rightDelimiter?n.length-e.rightDelimiter.length:-1}return-1!==i&&-1!==r&&(s=n.substring(i,r+e.rightDelimiter.length),f="."===s.charAt(e.leftDelimiter.length),a="#"===s.charAt(e.leftDelimiter.length),f||a?s.length>=o+1:s.length>=o)}},
/**
 * Removes last curly from string.
 */
n.removeDelimiter=function(t,e){var n=i(e.leftDelimiter),r=i(e.rightDelimiter),l=new RegExp("[ \\n]?"+n+"[^"+n+r+"]+"+r+"$"),o=t.search(l);return-1!==o?t.slice(0,o):t},n.escapeRegExp=i,
/**
 * find corresponding opening block
 */
n.getMatchingOpeningToken=function(t,e){if("softbreak"===t[e].type)return!1;if(0===t[e].nesting)return t[e];for(var n=t[e].level,i=t[e].type.replace("_close","_open");e>=0;--e)if(t[e].type===i&&t[e].level===n)return t[e]};
/**
 * from https://github.com/markdown-it/markdown-it/blob/master/lib/common/utils.js
 */
var r=/[&<>"]/,l=/[&<>"]/g,o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function s(t){return o[t]}n.escapeHtml=function(t){return r.test(t)?t.replace(l,s):t}},{}]},{},[1])(1)});