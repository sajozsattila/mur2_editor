!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).implicitFigures=e()}}(function(){return function(){return function e(n,t,i){function r(l,c){if(!t[l]){if(!n[l]){var f="function"==typeof require&&require;if(!c&&f)return f(l,!0);if(o)return o(l,!0);var h=new Error("Cannot find module '"+l+"'");throw h.code="MODULE_NOT_FOUND",h}var p=t[l]={exports:{}};n[l][0].call(p.exports,function(e){return r(n[l][1][e]||e)},p,p.exports,e,n,t,i)}return t[l].exports}for(var o="function"==typeof require&&require,l=0;l<i.length;l++)r(i[l]);return r}}()({1:[function(e,n,t){"use strict";n.exports=function(e,n){n=n||{},e.core.ruler.before("linkify","implicit_figures",function(e){for(var t=1,i=1,r=e.tokens.length;i<r-1;++i){var o=e.tokens[i];if("inline"===o.type&&o.children&&(1===o.children.length||3===o.children.length)&&(1!==o.children.length||"image"===o.children[0].type)&&(3!==o.children.length||"link_open"===o.children[0].type&&"image"===o.children[1].type&&"link_close"===o.children[2].type)&&!(0!==i&&"paragraph_open"!==e.tokens[i-1].type||i!==r-1&&"paragraph_close"!==e.tokens[i+1].type)){var l,c=e.tokens[i-1];if(c.type="figure_open",c.tag="figure",e.tokens[i+1].type="figure_close",e.tokens[i+1].tag="figure",1==n.dataType&&e.tokens[i-1].attrPush(["data-type","image"]),1==n.link&&1===o.children.length&&(l=o.children[0],o.children.unshift(new e.Token("link_open","a",1)),o.children[0].attrPush(["href",l.attrGet("src")]),o.children.push(new e.Token("link_close","a",-1))),l=1===o.children.length?o.children[0]:o.children[1],1==n.figcaption&&l.children&&l.children.length&&(o.children.push(new e.Token("figcaption_open","figcaption",1)),o.children.splice(o.children.length,0,...l.children),o.children.push(new e.Token("figcaption_close","figcaption",-1)),l.children.length=0),n.copyAttrs&&l.attrs){const e=!0===n.copyAttrs?"":n.copyAttrs;c.attrs=l.attrs.filter(([n,t])=>n.match(e))}1==n.tabindex&&(e.tokens[i-1].attrPush(["tabindex",t]),t++)}}})}},{}]},{},[1])(1)});